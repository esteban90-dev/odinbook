<%= form_with model: [current_user, current_user.posts.new] do |f| %>
  <%= f.label :body %>
  <%= f.text_field :body %>

  <%= f.label :picture %>
  <%= f.file_field :picture %>

  <%= f.submit "create post" %>
<% end %>

<% @posts.each do |post| %>
  <div data-test="post-<%= post.id %>">
    <% if post.picture.attached? %>
      <%= image_tag post.picture %>
    <% end %>
    <%= post.body %>
    <%= post.user.name %>
    likes: <%= post.likes.count %>
    <% if post.likers.include?(current_user) %>
      <%= link_to "unlike", like_path(post.likes.where(liker: current_user).first.id), method: :delete %>
    <% else %>
      <%= link_to "like", post_likes_path(post.id), method: :post %>
    <% end %>
  </div> 
<% end %>